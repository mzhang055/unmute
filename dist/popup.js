(()=>{"use strict";class t{constructor(){if(this.totalCountEl=document.getElementById("totalCount"),this.lastPressEl=document.getElementById("lastPress"),this.currentStatusEl=document.getElementById("currentStatus"),this.clearBtn=document.getElementById("clearBtn"),this.statusDiv=document.getElementById("status"),!(this.totalCountEl&&this.lastPressEl&&this.currentStatusEl&&this.clearBtn&&this.statusDiv))throw new Error("Required DOM elements not found");this.init()}init(){this.clearBtn.addEventListener("click",this.handleClearStats.bind(this)),this.loadAndDisplayStats(),chrome.runtime.onMessage.addListener(t=>{"trackingUpdate"===t.action&&(this.updateStats(),this.showActiveStatus())}),setInterval(()=>this.loadAndDisplayStats(),1e3)}async loadAndDisplayStats(){try{const t=(await chrome.storage.local.get(["trackingStats"])).trackingStats||{totalCount:0,lastPress:"Never"};this.totalCountEl.textContent=t.totalCount.toString(),this.lastPressEl.textContent=t.lastPress}catch(t){console.error("Error loading stats:",t)}}async updateStats(){try{const t=(new Date).toLocaleTimeString(),s={totalCount:((await chrome.storage.local.get(["trackingStats"])).trackingStats||{totalCount:0,lastPress:"Never"}).totalCount+1,lastPress:t};await chrome.storage.local.set({trackingStats:s}),this.loadAndDisplayStats()}catch(t){console.error("Error updating stats:",t)}}showActiveStatus(){this.currentStatusEl.textContent="Active",this.currentStatusEl.className="stat-value status-active",setTimeout(()=>{this.currentStatusEl.textContent="Ready",this.currentStatusEl.className="stat-value status-ready"},2e3)}async handleClearStats(){try{const t={totalCount:0,lastPress:"Never"};await chrome.storage.local.set({trackingStats:t}),this.loadAndDisplayStats(),this.showStatus("Stats cleared successfully!","success")}catch(t){console.error("Error clearing stats:",t),this.showStatus("Failed to clear stats","error")}}showStatus(t,s){this.statusDiv.textContent=t,this.statusDiv.className=`status ${s}`,this.statusDiv.style.display="block",setTimeout(()=>this.hideStatus(),3e3)}hideStatus(){this.statusDiv.style.display="none"}}document.addEventListener("DOMContentLoaded",()=>{try{new t}catch(t){console.error("Failed to initialize popup:",t)}})})();